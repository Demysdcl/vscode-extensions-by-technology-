"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const chai_1 = require("chai");
const stream_buffers_1 = require("stream-buffers");
const web_socket_handler_1 = require("./web-socket-handler");
describe('WebSocket', () => {
    it('should handle output streams', () => {
        const osStream = new stream_buffers_1.WritableStreamBuffer();
        const errStream = new stream_buffers_1.WritableStreamBuffer();
        const fill1 = 1;
        const fill2 = 2;
        const buff1 = Buffer.alloc(1024, fill1);
        const buff2 = Buffer.alloc(512, fill2);
        web_socket_handler_1.WebSocketHandler.handleStandardStreams(web_socket_handler_1.WebSocketHandler.StdoutStream, buff1, osStream, errStream);
        chai_1.expect(osStream.size()).to.equal(1024);
        chai_1.expect(errStream.size()).to.equal(0);
        web_socket_handler_1.WebSocketHandler.handleStandardStreams(web_socket_handler_1.WebSocketHandler.StderrStream, buff2, osStream, errStream);
        chai_1.expect(osStream.size()).to.equal(1024);
        chai_1.expect(errStream.size()).to.equal(512);
        const outputBuffer1 = osStream.getContents();
        for (let i = 0; i < 1024; i++) {
            chai_1.expect(outputBuffer1[i]).to.equal(fill1);
        }
        const outputBuffer2 = errStream.getContents();
        for (let i = 0; i < 512; i++) {
            chai_1.expect(outputBuffer2[i]).to.equal(fill2);
        }
    });
});
//# sourceMappingURL=web-socket-handler_test.js.map