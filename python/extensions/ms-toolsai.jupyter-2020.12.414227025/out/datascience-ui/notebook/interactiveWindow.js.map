{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/datascience-ui/history-react/interactivePanel.less","webpack:///./src/datascience-ui/interactive-common/collapseButton.tsx","webpack:///./src/datascience-ui/interactive-common/inputHistory.ts","webpack:///./src/datascience-ui/history-react/redux/actions.ts","webpack:///./src/datascience-ui/history-react/interactiveCell.tsx","webpack:///./src/datascience-ui/history-react/interactivePanel.tsx","webpack:///./src/datascience-ui/history-react/redux/reducers/creation.ts","webpack:///./src/datascience-ui/history-react/redux/reducers/effects.ts","webpack:///./src/datascience-ui/history-react/redux/reducers/execution.ts","webpack:///./src/datascience-ui/history-react/redux/reducers/index.ts","webpack:///./src/datascience-ui/history-react/index.tsx","webpack:///./src/datascience-ui/history-react/redux/store.ts","webpack:///./src/datascience-ui/history-react/interactivePanel.less?214b","webpack:///external \"log4js\""],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","__esModule","undefined","default","headers","common","Accept","adapter","transformRequest","transformResponse","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","props","render","collapseInputPolygonClassNames","this","open","theme","collapseInputClassNames","visible","tooltip","ariaExpanded","className","title","onClick","version","baseProfile","width","height","points","fill","label","historyStack","completeUp","code","up","adjustCursors","completeDown","down","add","typed","last","reset","currentPos","createIncomingActionWithPayload","payload","messageDirection","createIncomingAction","actionCreators","focusInput","FOCUS_INPUT","restartKernel","RESTART_KERNEL","interruptKernel","INTERRUPT_KERNEL","deleteAllCells","DeleteAllCells","deleteCell","cellId","DELETE_CELL","undo","Undo","redo","Redo","linkClick","href","LINK_CLICK","showPlot","imageHtml","ShowPlot","toggleInputBlock","TOGGLE_INPUT_BLOCK","gotoCell","GOTO_CELL","copyCellCode","COPY_CELL_CODE","clickCell","CLICK_CELL","editCell","EDIT_CELL","versionId","modelId","model","id","forward","reverse","getValue","submitInput","SUBMIT_INPUT","toggleVariableExplorer","TOGGLE_VARIABLE_EXPLORER","setVariableExplorerHeight","containerHeight","gridHeight","SET_VARIABLE_EXPLORER_HEIGHT","expandAll","ExpandAll","collapseAll","CollapseAll","export","EXPORT","exportAs","EXPORT_NOTEBOOK_AS","showDataViewer","variable","columnSize","SHOW_DATA_VIEWER","editorLoaded","EDITOR_LOADED","scroll","isAtBottom","SCROLL","unfocus","UNFOCUS_CELL","codeCreated","CODE_CREATED","editorUnmounted","UNMOUNT","selectKernel","SelectKernel","selectServer","SELECT_SERVER","openSettings","setting","OPEN_SETTINGS","getVariableData","newExecutionCount","refreshCount","startIndex","pageSize","GET_VARIABLE_DATA","executionCount","sortColumn","sortAscending","widgetFailed","ex","IPYWIDGET_RENDER_FAILURE","runExternalCommand","buttonId","cell","ExecuteExternalCommand","prop","codeRef","wrapperRef","getCell","cellVM","isCodeCell","cell_type","renderNormalToolbar","hasNoSource","file","EmptyFileName","baseTheme","hidden","class","image","GoToSourceCode","Copy","Cancel","renderExternalButtons","onMouseClick","ev","stopPropagation","renderControls","busy","state","init","executing","collapseVisible","inputBlockCollapseNeeded","inputBlockShow","editable","execution_count","toString","isEditOnlyCell","EditCellId","toolbar","isBusy","count","editExecutionCount","inputBlockOpen","renderInput","editorOptions","history","inputHistory","codeTheme","onCodeChange","onCodeCreated","unfocused","onUnfocused","testMode","showWatermark","ref","monacoTheme","openLink","editorMeasureClassName","keyDown","isEditCell","onEditCellKeyDown","showLineNumbers","font","disableUndoStack","codeVersion","focusPending","language","isNotebookTrusted","_code","_file","hasOutput","finished","getCodeCell","onKeyDown","shiftKey","ctrlKey","metaKey","altKey","preventDefault","onKeyUp","onEditCellKeyUp","_cellId","editCellSubmit","editorInfo","isSuggesting","clear","editCellShiftEscape","focusedElement","activeElement","nextTabStop","findTabStop","focus","uri","showingMarkdownEditor","messages","renderNormalCell","componentDidUpdate","prevProps","selected","focused","giveFocus","scrollCount","scrollAndFlash","shouldComponentUpdate","nextProps","current","scrollIntoView","behavior","block","inline","classList","remove","contains","shouldRender","settings","showCellInputCode","directInput","shouldRenderResults","cellOuterClass","cellWrapperClass","themeMatplotlibPlots","role","tabIndex","expandImage","maxTextSize","enableScroll","buttons","externalButtons","forEach","button","index","running","disabled","statusToEnable","includes","codicon","Sync","outputs","hideOutput","contents","endPos","content","isDirty","direction","element","allFocusable","querySelectorAll","tabable","Array","filter","self","indexOf","InteractiveCellComponent","mapStateToProps","main","variableState","variables","mainPanelRef","mainPanelToolbarRef","contentPanelRef","renderCount","internalScrollCount","footerPanelClick","_event","getInputExecutionCount","currentExecutionCount","getContentProps","cellVMs","submittedText","skipNextScroll","renderCell","scrollToBottom","scrollDiv","scrollBeyondLastLine","extraSettings","editor","getVariableProps","toolbarHeight","offsetHeight","debugging","showDataExplorer","skipDefault","closeVariableExplorer","pageIn","pageInVariableData","fontSize","size","_index","containerRef","options","hover","enabled","autoFocus","kernel","div","handleScroll","alwaysScrollOnNewCell","computeIsAtBottom","currentTarget","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","dynamicFont","fontFamily","family","progressBar","loaded","style","rootCss","buildSettingsCss","renderToolbarPanel","renderVariablePanel","onScroll","renderContentPanel","renderFooterPanel","variableExplorerTooltip","redoStack","undoStack","Restart","Interrupt","VariableExplorer","SaveAs","ExportToPython","renderKernelSelection","shouldShowTrustMessage","variableProps","monacoReady","contentProps","editCellVM","allowInput","editPanelClass","colorizeInputBox","hasFocus","Creation","isCellSupported","alterCellVM","expanded","newCellVM","newText","text","extractInputBlockText","inputBlockText","split","concat","prepareCellVM","mainState","collapseCellInputCodeByDefault","hasBeenRun","startCell","arg","prevState","updateOrAdd","UpdateModel","source","kind","oldDirty","dirty","newDirty","fullText","currentText","updateCell","finishCell","pushStack","findIndex","newVMs","_c","unmount","LoadAllCellsComplete","cells","Effects","map","oldVM","updateSettings","newSettings","JSON","parse","newEditorOptions","newFontFamily","newFontSize","vscodeThemeName","knownDark","computeKnownDark","GetCssRequest","isDark","GetMonacoThemeRequest","scrollToCell","scrolled","unfocusCell","Execution","cloneDeep","startDebugging","stopDebugging","matcher","stripFirstMarker","newCell","splitLines","trim","firstLine","isMarkdown","collapseInputs","useQuickEdit","SubmitNewCell","reducerMap","selectJupyterURI","exportCells","showExportAsMenu","SAVE","save","started","LoadAllCells","LOAD_IPYWIDGET_CLASS_SUCCESS","handleLoadIPyWidgetClassSuccess","LOAD_IPYWIDGET_CLASS_FAILURE","handleLoadIPyWidgetClassFailure","IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED","notifyAboutUnsupportedWidgetVersions","handleIPyWidgetRenderFailure","StartCell","FinishCell","UpdateCellWithExecutionResults","RestartKernel","handleRestarted","GetCssResponse","handleCss","MonacoReady","GetMonacoThemeResponse","monacoThemeChange","GetAllCells","getAllCells","StartProgress","startProgress","StopProgress","stopProgress","UpdateSettings","StartDebugging","StopDebugging","ScrollToCell","UpdateKernel","updateStatus","LocInit","handleLocInit","UpdateDisplayData","handleUpdateDisplayData","HasCell","hasCell","UpdateExternalCellButtons","handleWebviewButtons","executeExternalCommand","postOffice","inTestMode","acquireVsCodeApi","ConnectedInteractiveEditor","store","widgetContainerId","getElementById","transform","locals","log4js"],"mappings":"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","file":"interactiveWindow.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"interactiveWindow\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({\"vendors~dataresource~geojson~modeldebug~nteract_transforms~nteract_transforms_vsdom\":\"vendors~dataresource~geojson~modeldebug~nteract_transforms~nteract_transforms_vsdom\",\"modeldebug\":\"modeldebug\",\"nteract_transforms_vsdom\":\"nteract_transforms_vsdom\",\"vendors~dataresource~vega\":\"vendors~dataresource~vega\",\"vendors~dataresource\":\"vendors~dataresource\",\"vendors~geojson\":\"vendors~geojson\",\"vendors~nteract_transforms\":\"vendors~nteract_transforms\",\"vendors~vega\":\"vendors~vega\",\"vega\":\"vega\",\"vendors~plotly\":\"vendors~plotly\"}[chunkId]||chunkId) + \".bundle.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\t(function (module) {\n \t\t  if (module.exports\n \t\t    && !module.exports.__esModule\n \t\t    && module.exports.default === undefined\n \t\t  ) {\n \t\t    if (module.exports.headers\n \t\t      && module.exports.headers.common\n \t\t      && module.exports.headers.common.Accept\n \t\t      && module.exports.adapter\n \t\t      && module.exports.transformRequest\n \t\t      && module.exports.transformResponse\n \t\t    ) {\n \t\t      return;\n \t\t    }\n \t\t    module.exports.default = module.exports;\n \t\t  }\n \t\t})(module);\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([7,\"monaco\",\"commons\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\nexports.i(require(\"-!../../../node_modules/css-loader/index.js!../interactive-common/common.css\"), \"\");\n\n// module\nexports.push([module.id, \"/* Import common styles and then override them below */\\n.toolbar-menu-bar-child {\\n  background: var(--override-background, var(--vscode-editor-background));\\n  z-index: 10;\\n}\\n#main-panel-content {\\n  grid-area: content;\\n  max-height: 100%;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n}\\n.messages-result-container {\\n  width: 100%;\\n}\\n.messages-result-container pre {\\n  white-space: pre-wrap;\\n  font-family: monospace;\\n  margin: 0px;\\n  word-break: break-all;\\n}\\n.cell-wrapper {\\n  margin: 0px;\\n  padding: 0px;\\n  display: block;\\n}\\n.cell-result-container {\\n  margin: 0px;\\n  display: grid;\\n  grid-auto-columns: minmax(0, 1fr);\\n}\\n.cell-outer {\\n  display: grid;\\n  grid-template-columns: auto minmax(0, 1fr) 8px;\\n  grid-column-gap: 3px;\\n  width: 100%;\\n}\\n.cell-output {\\n  margin: 0px;\\n  width: 100%;\\n  overflow-x: scroll;\\n  background: transparent;\\n}\\n.cell-output > div {\\n  background: var(--override-widget-background, var(--vscode-notifications-background));\\n}\\nxmp {\\n  margin: 0px;\\n}\\n.cell-input {\\n  margin: 0;\\n}\\n.markdown-cell-output {\\n  width: 100%;\\n  overflow-x: scroll;\\n}\\n.cell-output-text {\\n  white-space: pre-wrap;\\n  word-break: break-all;\\n  overflow-x: hidden;\\n}\\n\", \"\"]);\n\n// exports\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\n\r\nimport * as React from 'react';\r\nimport { getLocString } from '../react-common/locReactSide';\r\n\r\ninterface ICollapseButtonProps {\r\n    theme: string;\r\n    tooltip: string;\r\n    visible: boolean;\r\n    open: boolean;\r\n    label?: string;\r\n    onClick(): void;\r\n}\r\n\r\nexport class CollapseButton extends React.Component<ICollapseButtonProps> {\r\n    constructor(props: ICollapseButtonProps) {\r\n        super(props);\r\n    }\r\n\r\n    public render() {\r\n        const collapseInputPolygonClassNames = `collapse-input-svg ${\r\n            this.props.open ? ' collapse-input-svg-rotate' : ''\r\n        } collapse-input-svg-${this.props.theme}`;\r\n        const collapseInputClassNames = `collapse-input remove-style ${this.props.visible ? '' : ' invisible'}`;\r\n        const tooltip = this.props.open\r\n            ? getLocString('DataScience.collapseSingle', 'Collapse')\r\n            : getLocString('DataScience.expandSingle', 'Expand');\r\n        const ariaExpanded = this.props.open ? 'true' : 'false';\r\n        // https://reactjs.org/docs/conditional-rendering.html#inline-if-with-logical--operator\r\n        // Comment here just because the (boolean && statement) was new to me\r\n        return (\r\n            <button\r\n                className={collapseInputClassNames}\r\n                title={tooltip}\r\n                onClick={this.props.onClick}\r\n                aria-expanded={ariaExpanded}\r\n            >\r\n                <svg version=\"1.1\" baseProfile=\"full\" width=\"8px\" height=\"11px\">\r\n                    <polygon points=\"0,0 0,10 5,5\" className={collapseInputPolygonClassNames} fill=\"black\" />\r\n                </svg>\r\n                {this.props.label && <label className=\"collapseInputLabel\">{this.props.label}</label>}\r\n            </button>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\n\r\nexport class InputHistory {\r\n    private historyStack: string[] = [];\r\n    private up: number | undefined;\r\n    private down: number | undefined;\r\n    private last: number | undefined;\r\n\r\n    public completeUp(code: string): string {\r\n        // If going up, only move if anything in the history\r\n        if (this.historyStack.length > 0) {\r\n            if (this.up === undefined) {\r\n                this.up = 0;\r\n            }\r\n\r\n            const result = this.up < this.historyStack.length ? this.historyStack[this.up] : code;\r\n            this.adjustCursors(this.up);\r\n            return result;\r\n        }\r\n\r\n        return code;\r\n    }\r\n\r\n    public completeDown(code: string): string {\r\n        // If going down, move and then return something if we have a position\r\n        if (this.historyStack.length > 0 && this.down !== undefined) {\r\n            const result = this.historyStack[this.down];\r\n            this.adjustCursors(this.down);\r\n            return result;\r\n        }\r\n\r\n        return code;\r\n    }\r\n\r\n    public add(code: string, typed: boolean) {\r\n        // Compute our new history. Behavior depends upon if the user typed it in or\r\n        // just used the arrows\r\n\r\n        // Only skip adding a dupe if it's the same as the top item. Otherwise\r\n        // add it as normal.\r\n        this.historyStack =\r\n            this.last === 0 && this.historyStack.length > 0 && this.historyStack[this.last] === code\r\n                ? this.historyStack\r\n                : [code, ...this.historyStack];\r\n\r\n        // Position is more complicated. If we typed something start over\r\n        if (typed) {\r\n            this.reset();\r\n        } else {\r\n            // We want our next up push to match the index of the item that was\r\n            // actually entered.\r\n            if (this.last === 0) {\r\n                this.up = undefined;\r\n                this.down = undefined;\r\n            } else if (this.last) {\r\n                this.up = this.last + 1;\r\n                this.down = this.last - 1;\r\n            }\r\n        }\r\n    }\r\n\r\n    private reset() {\r\n        this.up = undefined;\r\n        this.down = undefined;\r\n    }\r\n\r\n    private adjustCursors(currentPos: number) {\r\n        // Save last position we entered.\r\n        this.last = currentPos;\r\n\r\n        // For a single item, ony up works. But never modify it.\r\n        if (this.historyStack.length > 1) {\r\n            if (currentPos < this.historyStack.length) {\r\n                this.up = currentPos + 1;\r\n            } else {\r\n                this.up = this.historyStack.length;\r\n\r\n                // If we go off the end, don't make the down go up to the last.\r\n                // CMD prompt behaves this way. Down is always one off.\r\n                currentPos = this.historyStack.length - 1;\r\n            }\r\n            if (currentPos > 0) {\r\n                this.down = currentPos - 1;\r\n            } else {\r\n                this.down = undefined;\r\n            }\r\n        }\r\n    }\r\n}\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\n\r\nimport {\r\n    IInteractiveWindowMapping,\r\n    InteractiveWindowMessages\r\n} from '../../../client/datascience/interactive-common/interactiveWindowTypes';\r\nimport {\r\n    ICell,\r\n    IExternalCommandFromWebview,\r\n    IJupyterVariable,\r\n    IJupyterVariablesRequest\r\n} from '../../../client/datascience/types';\r\nimport {\r\n    CommonAction,\r\n    CommonActionType,\r\n    CommonActionTypeMapping,\r\n    ICellAction,\r\n    ICodeAction,\r\n    ICodeCreatedAction,\r\n    IEditCellAction,\r\n    ILinkClickAction,\r\n    IOpenSettingsAction,\r\n    IScrollAction,\r\n    IShowDataViewerAction,\r\n    IVariableExplorerHeight\r\n} from '../../interactive-common/redux/reducers/types';\r\nimport { IMonacoModelContentChangeEvent } from '../../react-common/monacoHelpers';\r\n\r\n// This function isn't made common and not exported, to ensure it isn't used elsewhere.\r\nfunction createIncomingActionWithPayload<\r\n    M extends IInteractiveWindowMapping & CommonActionTypeMapping,\r\n    K extends keyof M\r\n>(type: K, data: M[K]): CommonAction<M[K]> {\r\n    // tslint:disable-next-line: no-any\r\n    return { type, payload: { data, messageDirection: 'incoming' } as any } as any;\r\n}\r\n// This function isn't made common and not exported, to ensure it isn't used elsewhere.\r\nfunction createIncomingAction(type: CommonActionType | InteractiveWindowMessages): CommonAction {\r\n    return { type, payload: { messageDirection: 'incoming', data: undefined } };\r\n}\r\n\r\n// See https://react-redux.js.org/using-react-redux/connect-mapdispatch#defining-mapdispatchtoprops-as-an-object\r\nexport const actionCreators = {\r\n    focusInput: (): CommonAction => createIncomingAction(CommonActionType.FOCUS_INPUT),\r\n    restartKernel: (): CommonAction => createIncomingAction(CommonActionType.RESTART_KERNEL),\r\n    interruptKernel: (): CommonAction => createIncomingAction(CommonActionType.INTERRUPT_KERNEL),\r\n    deleteAllCells: (): CommonAction => createIncomingAction(InteractiveWindowMessages.DeleteAllCells),\r\n    deleteCell: (cellId: string): CommonAction<ICellAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.DELETE_CELL, { cellId }),\r\n    undo: (): CommonAction => createIncomingAction(InteractiveWindowMessages.Undo),\r\n    redo: (): CommonAction => createIncomingAction(InteractiveWindowMessages.Redo),\r\n    linkClick: (href: string): CommonAction<ILinkClickAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.LINK_CLICK, { href }),\r\n    showPlot: (imageHtml: string) => createIncomingActionWithPayload(InteractiveWindowMessages.ShowPlot, imageHtml),\r\n    toggleInputBlock: (cellId: string): CommonAction<ICellAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.TOGGLE_INPUT_BLOCK, { cellId }),\r\n    gotoCell: (cellId: string): CommonAction<ICellAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.GOTO_CELL, { cellId }),\r\n    copyCellCode: (cellId: string): CommonAction<ICellAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.COPY_CELL_CODE, { cellId }),\r\n    clickCell: (cellId: string): CommonAction<ICellAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.CLICK_CELL, { cellId }),\r\n    editCell: (cellId: string, e: IMonacoModelContentChangeEvent): CommonAction<IEditCellAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.EDIT_CELL, {\r\n            cellId,\r\n            version: e.versionId,\r\n            modelId: e.model.id,\r\n            forward: e.forward,\r\n            reverse: e.reverse,\r\n            id: cellId,\r\n            code: e.model.getValue()\r\n        }),\r\n    submitInput: (code: string, cellId: string): CommonAction<ICodeAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.SUBMIT_INPUT, { code, cellId }),\r\n    toggleVariableExplorer: (): CommonAction => createIncomingAction(CommonActionType.TOGGLE_VARIABLE_EXPLORER),\r\n    setVariableExplorerHeight: (containerHeight: number, gridHeight: number): CommonAction<IVariableExplorerHeight> =>\r\n        createIncomingActionWithPayload(CommonActionType.SET_VARIABLE_EXPLORER_HEIGHT, { containerHeight, gridHeight }),\r\n    expandAll: (): CommonAction => createIncomingAction(InteractiveWindowMessages.ExpandAll),\r\n    collapseAll: (): CommonAction => createIncomingAction(InteractiveWindowMessages.CollapseAll),\r\n    export: (): CommonAction => createIncomingAction(CommonActionType.EXPORT),\r\n    exportAs: (): CommonAction => createIncomingAction(CommonActionType.EXPORT_NOTEBOOK_AS),\r\n    showDataViewer: (variable: IJupyterVariable, columnSize: number): CommonAction<IShowDataViewerAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.SHOW_DATA_VIEWER, { variable, columnSize }),\r\n    editorLoaded: (): CommonAction => createIncomingAction(CommonActionType.EDITOR_LOADED),\r\n    scroll: (isAtBottom: boolean): CommonAction<IScrollAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.SCROLL, { isAtBottom }),\r\n    unfocus: (cellId: string | undefined): CommonAction<ICellAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.UNFOCUS_CELL, { cellId }),\r\n    codeCreated: (cellId: string | undefined, modelId: string): CommonAction<ICodeCreatedAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.CODE_CREATED, { cellId, modelId }),\r\n    editorUnmounted: (): CommonAction => createIncomingAction(CommonActionType.UNMOUNT),\r\n    selectKernel: (): CommonAction => createIncomingAction(InteractiveWindowMessages.SelectKernel),\r\n    selectServer: (): CommonAction => createIncomingAction(CommonActionType.SELECT_SERVER),\r\n    openSettings: (setting?: string): CommonAction<IOpenSettingsAction> =>\r\n        createIncomingActionWithPayload(CommonActionType.OPEN_SETTINGS, { setting }),\r\n    getVariableData: (\r\n        newExecutionCount: number,\r\n        refreshCount: number,\r\n        startIndex: number = 0,\r\n        pageSize: number = 100\r\n    ): CommonAction<IJupyterVariablesRequest> =>\r\n        createIncomingActionWithPayload(CommonActionType.GET_VARIABLE_DATA, {\r\n            executionCount: newExecutionCount,\r\n            sortColumn: 'name',\r\n            sortAscending: true,\r\n            startIndex,\r\n            pageSize,\r\n            refreshCount\r\n        }),\r\n    widgetFailed: (ex: Error): CommonAction<Error> =>\r\n        createIncomingActionWithPayload(CommonActionType.IPYWIDGET_RENDER_FAILURE, ex),\r\n    runExternalCommand: (buttonId: string, cell: ICell): CommonAction<IExternalCommandFromWebview> =>\r\n        createIncomingActionWithPayload(InteractiveWindowMessages.ExecuteExternalCommand, { buttonId, cell })\r\n};\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\nimport '../../client/common/extensions';\r\n\r\nimport { nbformat } from '@jupyterlab/coreutils';\r\nimport * as fastDeepEqual from 'fast-deep-equal';\r\nimport * as monacoEditor from 'monaco-editor/esm/vs/editor/editor.api';\r\nimport * as React from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport { Identifiers } from '../../client/datascience/constants';\r\nimport { CellState, IExternalWebviewCellButton, IJupyterExtraSettings } from '../../client/datascience/types';\r\nimport { CellInput } from '../interactive-common/cellInput';\r\nimport { CellOutput } from '../interactive-common/cellOutput';\r\nimport { CollapseButton } from '../interactive-common/collapseButton';\r\nimport { ExecutionCount } from '../interactive-common/executionCount';\r\nimport { InformationMessages } from '../interactive-common/informationMessages';\r\nimport { InputHistory } from '../interactive-common/inputHistory';\r\nimport { ICellViewModel, IFont } from '../interactive-common/mainState';\r\nimport { IKeyboardEvent } from '../react-common/event';\r\nimport { Image, ImageName } from '../react-common/image';\r\nimport { ImageButton } from '../react-common/imageButton';\r\nimport { getLocString } from '../react-common/locReactSide';\r\nimport { IMonacoModelContentChangeEvent } from '../react-common/monacoHelpers';\r\nimport { actionCreators } from './redux/actions';\r\n\r\ninterface IInteractiveCellBaseProps {\r\n    role?: string;\r\n    cellVM: ICellViewModel;\r\n    language: string;\r\n    baseTheme: string;\r\n    codeTheme: string;\r\n    testMode?: boolean;\r\n    autoFocus: boolean;\r\n    maxTextSize?: number;\r\n    enableScroll?: boolean;\r\n    showWatermark: boolean;\r\n    monacoTheme: string | undefined;\r\n    editorOptions?: monacoEditor.editor.IEditorOptions;\r\n    editExecutionCount?: string;\r\n    editorMeasureClassName?: string;\r\n    font: IFont;\r\n    settings: IJupyterExtraSettings;\r\n    focusPending: number;\r\n    externalButtons: IExternalWebviewCellButton[];\r\n}\r\n\r\ntype IInteractiveCellProps = IInteractiveCellBaseProps & typeof actionCreators;\r\n\r\n// tslint:disable: react-this-binding-issue\r\nexport class InteractiveCell extends React.Component<IInteractiveCellProps> {\r\n    private codeRef: React.RefObject<CellInput> = React.createRef<CellInput>();\r\n    private wrapperRef: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\r\n    private inputHistory: InputHistory | undefined;\r\n\r\n    constructor(prop: IInteractiveCellProps) {\r\n        super(prop);\r\n        this.state = { showingMarkdownEditor: false };\r\n        if (prop.cellVM.cell.id === Identifiers.EditCellId) {\r\n            this.inputHistory = new InputHistory();\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        if (this.props.cellVM.cell.data.cell_type === 'messages') {\r\n            return <InformationMessages messages={this.props.cellVM.cell.data.messages} />;\r\n        } else {\r\n            return this.renderNormalCell();\r\n        }\r\n    }\r\n\r\n    public componentDidUpdate(prevProps: IInteractiveCellProps) {\r\n        if (this.props.cellVM.selected && !prevProps.cellVM.selected && !this.props.cellVM.focused) {\r\n            this.giveFocus();\r\n        }\r\n        if (this.props.cellVM.scrollCount !== prevProps.cellVM.scrollCount) {\r\n            this.scrollAndFlash();\r\n        }\r\n    }\r\n\r\n    public shouldComponentUpdate(nextProps: IInteractiveCellProps): boolean {\r\n        return !fastDeepEqual(this.props, nextProps);\r\n    }\r\n\r\n    private scrollAndFlash() {\r\n        if (this.wrapperRef && this.wrapperRef.current) {\r\n            // tslint:disable-next-line: no-any\r\n            if ((this.wrapperRef.current as any).scrollIntoView) {\r\n                this.wrapperRef.current.scrollIntoView({ behavior: 'auto', block: 'nearest', inline: 'nearest' });\r\n            }\r\n            this.wrapperRef.current.classList.add('flash');\r\n            setTimeout(() => {\r\n                if (this.wrapperRef.current) {\r\n                    this.wrapperRef.current.classList.remove('flash');\r\n                }\r\n            }, 1000);\r\n        }\r\n    }\r\n\r\n    private giveFocus() {\r\n        // Start out with ourselves\r\n        if (this.wrapperRef && this.wrapperRef.current) {\r\n            // Give focus to the cell if not already owning focus\r\n            if (!this.wrapperRef.current.contains(document.activeElement)) {\r\n                this.wrapperRef.current.focus();\r\n            }\r\n\r\n            // Scroll into view (since we have focus). However this function\r\n            // is not supported on enzyme\r\n            // tslint:disable-next-line: no-any\r\n            if ((this.wrapperRef.current as any).scrollIntoView) {\r\n                this.wrapperRef.current.scrollIntoView({ behavior: 'auto', block: 'nearest', inline: 'nearest' });\r\n            }\r\n        }\r\n    }\r\n\r\n    private toggleInputBlock = () => {\r\n        const cellId: string = this.getCell().id;\r\n        this.props.toggleInputBlock(cellId);\r\n    };\r\n\r\n    private getCell = () => {\r\n        return this.props.cellVM.cell;\r\n    };\r\n\r\n    private isCodeCell = () => {\r\n        return this.props.cellVM.cell.data.cell_type === 'code';\r\n    };\r\n\r\n    private renderNormalCell() {\r\n        const allowsPlainInput =\r\n            this.props.settings.showCellInputCode || this.props.cellVM.directInput || this.props.cellVM.editable;\r\n        const shouldRender = allowsPlainInput || this.shouldRenderResults();\r\n        const cellOuterClass = this.props.cellVM.editable ? 'cell-outer-editable' : 'cell-outer';\r\n        const cellWrapperClass = this.props.cellVM.editable ? 'cell-wrapper' : 'cell-wrapper cell-wrapper-noneditable';\r\n        const themeMatplotlibPlots = this.props.settings.themeMatplotlibPlots ? true : false;\r\n        // Only render if we are allowed to.\r\n        if (shouldRender) {\r\n            return (\r\n                <div\r\n                    className={cellWrapperClass}\r\n                    role={this.props.role}\r\n                    ref={this.wrapperRef}\r\n                    tabIndex={0}\r\n                    onKeyDown={this.onKeyDown}\r\n                    onKeyUp={this.onKeyUp}\r\n                    onClick={this.onMouseClick}\r\n                >\r\n                    <div className={cellOuterClass}>\r\n                        {this.renderControls()}\r\n                        <div className=\"content-div\">\r\n                            <div className=\"cell-result-container\">\r\n                                {this.renderInput()}\r\n                                <div>\r\n                                    <CellOutput\r\n                                        cellVM={this.props.cellVM}\r\n                                        baseTheme={this.props.baseTheme}\r\n                                        expandImage={this.props.showPlot}\r\n                                        maxTextSize={this.props.maxTextSize}\r\n                                        enableScroll={this.props.enableScroll}\r\n                                        themeMatplotlibPlots={themeMatplotlibPlots}\r\n                                        widgetFailed={this.props.widgetFailed}\r\n                                        openSettings={this.props.openSettings}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        // Shouldn't be rendered because not allowing empty input and not a direct input cell\r\n        return null;\r\n    }\r\n\r\n    private renderNormalToolbar = () => {\r\n        const cell = this.getCell();\r\n        const cellId = cell.id;\r\n        const gotoCode = () => this.props.gotoCell(cellId);\r\n        const deleteCode = () => this.props.deleteCell(cellId);\r\n        const copyCode = () => this.props.copyCellCode(cellId);\r\n        const hasNoSource = !cell || !cell.file || cell.file === Identifiers.EmptyFileName;\r\n\r\n        return (\r\n            <div className=\"cell-toolbar\" key={0}>\r\n                <ImageButton\r\n                    baseTheme={this.props.baseTheme}\r\n                    onClick={gotoCode}\r\n                    tooltip={getLocString('DataScience.gotoCodeButtonTooltip', 'Go to code')}\r\n                    hidden={hasNoSource}\r\n                >\r\n                    <Image\r\n                        baseTheme={this.props.baseTheme}\r\n                        class=\"image-button-image\"\r\n                        image={ImageName.GoToSourceCode}\r\n                    />\r\n                </ImageButton>\r\n                <ImageButton\r\n                    baseTheme={this.props.baseTheme}\r\n                    onClick={copyCode}\r\n                    tooltip={getLocString('DataScience.copyBackToSourceButtonTooltip', 'Paste code into file')}\r\n                    hidden={!hasNoSource}\r\n                >\r\n                    <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Copy} />\r\n                </ImageButton>\r\n                <ImageButton\r\n                    baseTheme={this.props.baseTheme}\r\n                    onClick={deleteCode}\r\n                    tooltip={getLocString('DataScience.deleteButtonTooltip', 'Remove Cell')}\r\n                >\r\n                    <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Cancel} />\r\n                </ImageButton>\r\n                {this.renderExternalButtons()}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    private renderExternalButtons() {\r\n        const buttons: JSX.Element[] = [];\r\n\r\n        this.props.externalButtons.forEach((button, index) => {\r\n            if (this.isCodeCell()) {\r\n                buttons.push(\r\n                    <ImageButton\r\n                        baseTheme={this.props.baseTheme}\r\n                        onClick={() => {\r\n                            button.running = true;\r\n                            this.props.runExternalCommand(button.buttonId, this.props.cellVM.cell);\r\n                        }}\r\n                        disabled={!button.statusToEnable.includes(this.props.cellVM.cell.state)}\r\n                        tooltip={button.tooltip}\r\n                        key={index}\r\n                    >\r\n                        <Image\r\n                            baseTheme={this.props.baseTheme}\r\n                            class=\"image-button-image\"\r\n                            codicon={button.running ? undefined : button.codicon}\r\n                            image={button.running ? ImageName.Sync : ImageName.Cancel}\r\n                        />\r\n                    </ImageButton>\r\n                );\r\n            }\r\n        });\r\n\r\n        return buttons;\r\n    }\r\n\r\n    private onMouseClick = (ev: React.MouseEvent<HTMLDivElement>) => {\r\n        // When we receive a click, propagate upwards. Might change our state\r\n        ev.stopPropagation();\r\n        this.props.clickCell(this.props.cellVM.cell.id);\r\n    };\r\n\r\n    private renderControls = () => {\r\n        const busy =\r\n            this.props.cellVM.cell.state === CellState.init || this.props.cellVM.cell.state === CellState.executing;\r\n        const collapseVisible =\r\n            this.props.cellVM.inputBlockCollapseNeeded &&\r\n            this.props.cellVM.inputBlockShow &&\r\n            !this.props.cellVM.editable &&\r\n            this.isCodeCell();\r\n        const executionCount =\r\n            this.props.cellVM &&\r\n            this.props.cellVM.cell &&\r\n            this.props.cellVM.cell.data &&\r\n            this.props.cellVM.cell.data.execution_count\r\n                ? this.props.cellVM.cell.data.execution_count.toString()\r\n                : '-';\r\n        const isEditOnlyCell = this.props.cellVM.cell.id === Identifiers.EditCellId;\r\n        const toolbar = isEditOnlyCell ? null : this.renderNormalToolbar();\r\n\r\n        return (\r\n            <div className=\"controls-div\">\r\n                <ExecutionCount\r\n                    isBusy={busy}\r\n                    count={\r\n                        isEditOnlyCell && this.props.editExecutionCount ? this.props.editExecutionCount : executionCount\r\n                    }\r\n                    visible={this.isCodeCell()}\r\n                />\r\n                <CollapseButton\r\n                    theme={this.props.baseTheme}\r\n                    visible={collapseVisible}\r\n                    open={this.props.cellVM.inputBlockOpen}\r\n                    onClick={this.toggleInputBlock}\r\n                    tooltip={getLocString('DataScience.collapseInputTooltip', 'Collapse input block')}\r\n                />\r\n                {toolbar}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    private renderInput = () => {\r\n        if (this.isCodeCell()) {\r\n            return (\r\n                <CellInput\r\n                    cellVM={this.props.cellVM}\r\n                    editorOptions={this.props.editorOptions}\r\n                    history={this.inputHistory}\r\n                    codeTheme={this.props.codeTheme}\r\n                    onCodeChange={this.onCodeChange}\r\n                    onCodeCreated={this.onCodeCreated}\r\n                    unfocused={this.onUnfocused}\r\n                    testMode={this.props.testMode ? true : false}\r\n                    showWatermark={this.props.showWatermark}\r\n                    ref={this.codeRef}\r\n                    monacoTheme={this.props.monacoTheme}\r\n                    openLink={this.openLink}\r\n                    editorMeasureClassName={this.props.editorMeasureClassName}\r\n                    keyDown={this.isEditCell() ? this.onEditCellKeyDown : undefined}\r\n                    showLineNumbers={this.props.cellVM.showLineNumbers}\r\n                    font={this.props.font}\r\n                    disableUndoStack={this.props.cellVM.cell.id !== Identifiers.EditCellId}\r\n                    codeVersion={this.props.cellVM.codeVersion ? this.props.cellVM.codeVersion : 0}\r\n                    focusPending={this.props.focusPending}\r\n                    language={this.props.language}\r\n                    isNotebookTrusted={true}\r\n                />\r\n            );\r\n        }\r\n        return null;\r\n    };\r\n\r\n    private isEditCell(): boolean {\r\n        return this.getCell().id === Identifiers.EditCellId;\r\n    }\r\n\r\n    private onUnfocused = () => {\r\n        this.props.unfocus(this.getCell().id);\r\n    };\r\n\r\n    private onCodeChange = (e: IMonacoModelContentChangeEvent) => {\r\n        this.props.editCell(this.getCell().id, e);\r\n    };\r\n\r\n    private onCodeCreated = (_code: string, _file: string, cellId: string, modelId: string) => {\r\n        this.props.codeCreated(cellId, modelId);\r\n    };\r\n\r\n    private hasOutput = () => {\r\n        return (\r\n            this.getCell().state === CellState.finished ||\r\n            this.getCell().state === CellState.error ||\r\n            this.getCell().state === CellState.executing\r\n        );\r\n    };\r\n\r\n    private getCodeCell = () => {\r\n        return this.props.cellVM.cell.data as nbformat.ICodeCell;\r\n    };\r\n\r\n    private shouldRenderResults(): boolean {\r\n        return (\r\n            this.isCodeCell() &&\r\n            this.hasOutput() &&\r\n            this.getCodeCell().outputs &&\r\n            this.getCodeCell().outputs.length > 0 &&\r\n            !this.props.cellVM.hideOutput\r\n        );\r\n    }\r\n\r\n    private onKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\r\n        // Handle keydown events for the entire cell\r\n        if (this.getCell().id === Identifiers.EditCellId) {\r\n            const e: IKeyboardEvent = {\r\n                code: event.key,\r\n                shiftKey: event.shiftKey,\r\n                ctrlKey: event.ctrlKey,\r\n                metaKey: event.metaKey,\r\n                altKey: event.altKey,\r\n                target: event.target as HTMLDivElement,\r\n                stopPropagation: () => event.stopPropagation(),\r\n                preventDefault: () => event.preventDefault()\r\n            };\r\n            this.onEditCellKeyDown(Identifiers.EditCellId, e);\r\n        }\r\n    };\r\n\r\n    private onKeyUp = (event: React.KeyboardEvent<HTMLDivElement>) => {\r\n        // Handle keydown events for the entire cell\r\n        if (this.getCell().id === Identifiers.EditCellId) {\r\n            const e: IKeyboardEvent = {\r\n                code: event.key,\r\n                shiftKey: event.shiftKey,\r\n                ctrlKey: event.ctrlKey,\r\n                metaKey: event.metaKey,\r\n                altKey: event.altKey,\r\n                target: event.target as HTMLDivElement,\r\n                stopPropagation: () => event.stopPropagation(),\r\n                preventDefault: () => event.preventDefault()\r\n            };\r\n            this.onEditCellKeyUp(Identifiers.EditCellId, e);\r\n        }\r\n    };\r\n\r\n    private onEditCellKeyDown = (_cellId: string, e: IKeyboardEvent) => {\r\n        if (e.code === 'Enter' && e.shiftKey) {\r\n            this.editCellSubmit(e);\r\n        } else if (e.code === 'NumpadEnter' && e.shiftKey) {\r\n            this.editCellSubmit(e);\r\n        } else if (e.code === 'KeyU' && e.ctrlKey && e.editorInfo && !e.editorInfo.isSuggesting) {\r\n            e.editorInfo.clear();\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        } else if (e.code === 'Escape' && !e.shiftKey && e.editorInfo && !e.editorInfo.isSuggesting) {\r\n            e.editorInfo.clear();\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        }\r\n    };\r\n\r\n    private onEditCellKeyUp = (_cellId: string, e: IKeyboardEvent) => {\r\n        // Special case. Escape + Shift only comes as a key up because shift comes as the\r\n        // key down.\r\n        if (e.code === 'Escape' && e.shiftKey) {\r\n            this.editCellShiftEscape(e);\r\n        }\r\n    };\r\n\r\n    private editCellSubmit(e: IKeyboardEvent) {\r\n        if (e.editorInfo && e.editorInfo.contents) {\r\n            // Prevent shift+enter from turning into a enter\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n\r\n            // Remove empty lines off the end\r\n            let endPos = e.editorInfo.contents.length - 1;\r\n            while (endPos >= 0 && e.editorInfo.contents[endPos] === '\\n') {\r\n                endPos -= 1;\r\n            }\r\n            const content = e.editorInfo.contents.slice(0, endPos + 1);\r\n\r\n            // Send to the input history too if necessary\r\n            if (this.inputHistory) {\r\n                this.inputHistory.add(content, e.editorInfo.isDirty);\r\n            }\r\n\r\n            // Clear our editor\r\n            e.editorInfo.clear();\r\n\r\n            // Send to jupyter\r\n            this.props.submitInput(content, this.props.cellVM.cell.id);\r\n        }\r\n    }\r\n\r\n    private findTabStop(direction: number, element: Element): HTMLElement | undefined {\r\n        if (element) {\r\n            const allFocusable = document.querySelectorAll('input, button, select, textarea, a[href]');\r\n            if (allFocusable) {\r\n                const tabable = Array.prototype.filter.call(allFocusable, (i: HTMLElement) => i.tabIndex >= 0);\r\n                const self = tabable.indexOf(element);\r\n                return direction >= 0 ? tabable[self + 1] || tabable[0] : tabable[self - 1] || tabable[0];\r\n            }\r\n        }\r\n    }\r\n\r\n    private editCellShiftEscape = (e: IKeyboardEvent) => {\r\n        const focusedElement = document.activeElement;\r\n        if (focusedElement !== null) {\r\n            const nextTabStop = this.findTabStop(1, focusedElement);\r\n            if (nextTabStop) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                nextTabStop.focus();\r\n            }\r\n        }\r\n    };\r\n\r\n    private openLink = (uri: monacoEditor.Uri) => {\r\n        this.props.linkClick(uri.toString());\r\n    };\r\n}\r\n\r\n// Main export, return a redux connected editor\r\nexport const InteractiveCellComponent = connect(null, actionCreators)(InteractiveCell);\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Identifiers } from '../../client/datascience/constants';\r\nimport { buildSettingsCss } from '../interactive-common/buildSettingsCss';\r\nimport { ContentPanel, IContentPanelProps } from '../interactive-common/contentPanel';\r\nimport { handleLinkClick } from '../interactive-common/handlers';\r\nimport { JupyterInfo } from '../interactive-common/jupyterInfo';\r\nimport { ICellViewModel } from '../interactive-common/mainState';\r\nimport { IMainWithVariables, IStore } from '../interactive-common/redux/store';\r\nimport { IVariablePanelProps, VariablePanel } from '../interactive-common/variablePanel';\r\nimport { ErrorBoundary } from '../react-common/errorBoundary';\r\nimport { Image, ImageName } from '../react-common/image';\r\nimport { ImageButton } from '../react-common/imageButton';\r\nimport { getLocString } from '../react-common/locReactSide';\r\nimport { Progress } from '../react-common/progress';\r\nimport { InteractiveCellComponent } from './interactiveCell';\r\nimport './interactivePanel.less';\r\nimport { actionCreators } from './redux/actions';\r\n\r\n// tslint:disable: no-suspicious-comment\r\n\r\nexport type IInteractivePanelProps = IMainWithVariables & typeof actionCreators;\r\n\r\nfunction mapStateToProps(state: IStore): IMainWithVariables {\r\n    return { ...state.main, variableState: state.variables };\r\n}\r\n\r\nexport class InteractivePanel extends React.Component<IInteractivePanelProps> {\r\n    private mainPanelRef: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\r\n    private mainPanelToolbarRef: React.RefObject<HTMLDivElement> = React.createRef<HTMLDivElement>();\r\n    private contentPanelRef: React.RefObject<ContentPanel> = React.createRef<ContentPanel>();\r\n    private renderCount: number = 0;\r\n    private internalScrollCount: number = 0;\r\n\r\n    constructor(props: IInteractivePanelProps) {\r\n        super(props);\r\n    }\r\n\r\n    public componentDidMount() {\r\n        document.addEventListener('click', this.linkClick, true);\r\n        this.props.editorLoaded();\r\n    }\r\n\r\n    public componentWillUnmount() {\r\n        document.removeEventListener('click', this.linkClick);\r\n        this.props.editorUnmounted();\r\n    }\r\n\r\n    public render() {\r\n        const dynamicFont: React.CSSProperties = {\r\n            fontSize: this.props.font.size,\r\n            fontFamily: this.props.font.family\r\n        };\r\n\r\n        const progressBar = (this.props.busy || !this.props.loaded) && !this.props.testMode ? <Progress /> : undefined;\r\n\r\n        // If in test mode, update our count. Use this to determine how many renders a normal update takes.\r\n        if (this.props.testMode) {\r\n            this.renderCount = this.renderCount + 1;\r\n        }\r\n\r\n        return (\r\n            <div id=\"main-panel\" ref={this.mainPanelRef} role=\"Main\" style={dynamicFont}>\r\n                <div className=\"styleSetter\">\r\n                    <style>{`${this.props.rootCss ? this.props.rootCss : ''}\r\n${buildSettingsCss(this.props.settings)}`}</style>\r\n                </div>\r\n                <header id=\"main-panel-toolbar\" ref={this.mainPanelToolbarRef}>\r\n                    {this.renderToolbarPanel()}\r\n                    {progressBar}\r\n                </header>\r\n                <section\r\n                    id=\"main-panel-variable\"\r\n                    aria-label={getLocString('DataScience.collapseVariableExplorerLabel', 'Variables')}\r\n                >\r\n                    {this.renderVariablePanel(this.props.baseTheme)}\r\n                </section>\r\n                <main id=\"main-panel-content\" onScroll={this.handleScroll}>\r\n                    {this.renderContentPanel(this.props.baseTheme)}\r\n                </main>\r\n                <section\r\n                    id=\"main-panel-footer\"\r\n                    onClick={this.footerPanelClick}\r\n                    aria-label={getLocString('DataScience.editSection', 'Input new cells here')}\r\n                >\r\n                    {this.renderFooterPanel(this.props.baseTheme)}\r\n                </section>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Make the entire footer focus our input, instead of having to click directly on the monaco editor\r\n    private footerPanelClick = (_event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\r\n        this.props.focusInput();\r\n    };\r\n\r\n    // tslint:disable-next-line: max-func-body-length\r\n    private renderToolbarPanel() {\r\n        const variableExplorerTooltip = this.props.variableState.visible\r\n            ? getLocString('DataScience.collapseVariableExplorerTooltip', 'Hide variables active in jupyter kernel')\r\n            : getLocString('DataScience.expandVariableExplorerTooltip', 'Show variables active in jupyter kernel');\r\n\r\n        return (\r\n            <div id=\"toolbar-panel\">\r\n                <div className=\"toolbar-menu-bar\">\r\n                    <div className=\"toolbar-menu-bar-child\">\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.deleteAllCells}\r\n                            tooltip={getLocString('DataScience.clearAll', 'Remove all cells')}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.Cancel}\r\n                            />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.redo}\r\n                            disabled={this.props.redoStack.length === 0}\r\n                            tooltip={getLocString('DataScience.redo', 'Redo')}\r\n                        >\r\n                            <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Redo} />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.undo}\r\n                            disabled={this.props.undoStack.length === 0}\r\n                            tooltip={getLocString('DataScience.undo', 'Undo')}\r\n                        >\r\n                            <Image baseTheme={this.props.baseTheme} class=\"image-button-image\" image={ImageName.Undo} />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.restartKernel}\r\n                            tooltip={getLocString('DataScience.restartServer', 'Restart Jupyter kernel')}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.Restart}\r\n                            />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.interruptKernel}\r\n                            tooltip={getLocString('DataScience.interruptKernel', 'Interrupt Jupyter kernel')}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.Interrupt}\r\n                            />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.toggleVariableExplorer}\r\n                            tooltip={variableExplorerTooltip}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.VariableExplorer}\r\n                            />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.export}\r\n                            disabled={this.props.cellVMs.length === 0 || this.props.busy}\r\n                            tooltip={getLocString('DataScience.export', 'Export as Jupyter notebook')}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.SaveAs}\r\n                            />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.exportAs}\r\n                            disabled={this.props.busy || !this.props.isNotebookTrusted}\r\n                            className=\"native-button\"\r\n                            tooltip={getLocString('DataScience.notebookExportAs', 'Export as')}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.ExportToPython}\r\n                            />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.expandAll}\r\n                            disabled={this.props.cellVMs.length === 0}\r\n                            tooltip={getLocString('DataScience.expandAll', 'Expand all cell inputs')}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.ExpandAll}\r\n                            />\r\n                        </ImageButton>\r\n                        <ImageButton\r\n                            baseTheme={this.props.baseTheme}\r\n                            onClick={this.props.collapseAll}\r\n                            disabled={this.props.cellVMs.length === 0}\r\n                            tooltip={getLocString('DataScience.collapseAll', 'Collapse all cell inputs')}\r\n                        >\r\n                            <Image\r\n                                baseTheme={this.props.baseTheme}\r\n                                class=\"image-button-image\"\r\n                                image={ImageName.CollapseAll}\r\n                            />\r\n                        </ImageButton>\r\n                    </div>\r\n                    {this.renderKernelSelection()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private renderKernelSelection() {\r\n        return (\r\n            <JupyterInfo\r\n                baseTheme={this.props.baseTheme}\r\n                font={this.props.font}\r\n                kernel={this.props.kernel}\r\n                selectServer={this.props.selectServer}\r\n                selectKernel={this.props.selectKernel}\r\n                shouldShowTrustMessage={false}\r\n            />\r\n        );\r\n    }\r\n\r\n    private renderVariablePanel(baseTheme: string) {\r\n        if (this.props.variableState.visible) {\r\n            const variableProps = this.getVariableProps(baseTheme);\r\n            return <VariablePanel {...variableProps} />;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private renderContentPanel(baseTheme: string) {\r\n        // Skip if the tokenizer isn't finished yet. It needs\r\n        // to finish loading so our code editors work.\r\n        if (!this.props.monacoReady && !this.props.testMode) {\r\n            return null;\r\n        }\r\n\r\n        // Otherwise render our cells.\r\n        const contentProps = this.getContentProps(baseTheme);\r\n        return <ContentPanel {...contentProps} ref={this.contentPanelRef} />;\r\n    }\r\n\r\n    private renderFooterPanel(baseTheme: string) {\r\n        // Skip if the tokenizer isn't finished yet. It needs\r\n        // to finish loading so our code editors work.\r\n        if (\r\n            !this.props.monacoReady ||\r\n            !this.props.editCellVM ||\r\n            !this.props.settings ||\r\n            !this.props.editorOptions ||\r\n            !this.props.settings.allowInput\r\n        ) {\r\n            return null;\r\n        }\r\n\r\n        const executionCount = this.getInputExecutionCount();\r\n        const editPanelClass = this.props.settings.colorizeInputBox ? 'edit-panel-colorized' : 'edit-panel';\r\n\r\n        return (\r\n            <div className={editPanelClass}>\r\n                <ErrorBoundary>\r\n                    <InteractiveCellComponent\r\n                        role=\"form\"\r\n                        editorOptions={this.props.editorOptions}\r\n                        maxTextSize={undefined}\r\n                        enableScroll={false}\r\n                        autoFocus={document.hasFocus()}\r\n                        testMode={this.props.testMode}\r\n                        cellVM={this.props.editCellVM}\r\n                        baseTheme={baseTheme}\r\n                        codeTheme={this.props.codeTheme}\r\n                        showWatermark={true}\r\n                        editExecutionCount={executionCount.toString()}\r\n                        monacoTheme={this.props.monacoTheme}\r\n                        font={this.props.font}\r\n                        settings={this.props.settings}\r\n                        focusPending={this.props.focusPending}\r\n                        language={this.props.kernel.language}\r\n                        externalButtons={this.props.externalButtons}\r\n                    />\r\n                </ErrorBoundary>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private getInputExecutionCount = (): number => {\r\n        return this.props.currentExecutionCount + 1;\r\n    };\r\n\r\n    private getContentProps = (baseTheme: string): IContentPanelProps => {\r\n        return {\r\n            baseTheme: baseTheme,\r\n            cellVMs: this.props.cellVMs,\r\n            testMode: this.props.testMode,\r\n            codeTheme: this.props.codeTheme,\r\n            submittedText: this.props.submittedText,\r\n            settings: this.props.settings,\r\n            skipNextScroll: this.props.skipNextScroll ? true : false,\r\n            editable: false,\r\n            renderCell: this.renderCell,\r\n            scrollToBottom: this.scrollDiv,\r\n            scrollBeyondLastLine: this.props.settings\r\n                ? this.props.settings.extraSettings.editor.scrollBeyondLastLine\r\n                : false\r\n        };\r\n    };\r\n    private getVariableProps = (baseTheme: string): IVariablePanelProps => {\r\n        let toolbarHeight = 0;\r\n        if (this.mainPanelToolbarRef.current) {\r\n            toolbarHeight = this.mainPanelToolbarRef.current.offsetHeight;\r\n        }\r\n        return {\r\n            gridHeight: this.props.variableState.gridHeight,\r\n            containerHeight: this.props.variableState.containerHeight,\r\n            variables: this.props.variableState.variables,\r\n            debugging: this.props.debugging,\r\n            busy: this.props.busy,\r\n            showDataExplorer: this.props.showDataViewer,\r\n            skipDefault: this.props.skipDefault,\r\n            testMode: this.props.testMode,\r\n            closeVariableExplorer: this.props.toggleVariableExplorer,\r\n            setVariableExplorerHeight: this.props.setVariableExplorerHeight,\r\n            baseTheme: baseTheme,\r\n            pageIn: this.pageInVariableData,\r\n            fontSize: this.props.font.size,\r\n            executionCount: this.props.currentExecutionCount,\r\n            refreshCount: this.props.variableState.refreshCount,\r\n            offsetHeight: toolbarHeight\r\n        };\r\n    };\r\n\r\n    private pageInVariableData = (startIndex: number, pageSize: number) => {\r\n        this.props.getVariableData(\r\n            this.props.currentExecutionCount,\r\n            this.props.variableState.refreshCount,\r\n            startIndex,\r\n            pageSize\r\n        );\r\n    };\r\n\r\n    private renderCell = (\r\n        cellVM: ICellViewModel,\r\n        _index: number,\r\n        containerRef?: React.RefObject<HTMLDivElement>\r\n    ): JSX.Element | null => {\r\n        // Note: MaxOutputSize and enableScrollingForCellOutputs is being ignored on purpose for\r\n        // the interactive window. See bug: https://github.com/microsoft/vscode-python/issues/11421\r\n        if (this.props.settings && this.props.editorOptions) {\r\n            // Disable hover for collapsed code blocks\r\n            const options = { ...this.props.editorOptions, hover: { enabled: cellVM.inputBlockOpen } };\r\n            return (\r\n                <div key={cellVM.cell.id} id={cellVM.cell.id} ref={containerRef}>\r\n                    <ErrorBoundary>\r\n                        <InteractiveCellComponent\r\n                            role=\"listitem\"\r\n                            editorOptions={options}\r\n                            maxTextSize={undefined}\r\n                            enableScroll={false}\r\n                            autoFocus={false}\r\n                            testMode={this.props.testMode}\r\n                            cellVM={cellVM}\r\n                            baseTheme={this.props.baseTheme}\r\n                            codeTheme={this.props.codeTheme}\r\n                            showWatermark={cellVM.cell.id === Identifiers.EditCellId}\r\n                            editExecutionCount={this.getInputExecutionCount().toString()}\r\n                            monacoTheme={this.props.monacoTheme}\r\n                            font={this.props.font}\r\n                            settings={this.props.settings}\r\n                            focusPending={this.props.focusPending}\r\n                            language={this.props.kernel.language}\r\n                            externalButtons={this.props.externalButtons}\r\n                        />\r\n                    </ErrorBoundary>\r\n                </div>\r\n            );\r\n        } else {\r\n            return null;\r\n        }\r\n    };\r\n\r\n    // This handles the scrolling. Its called from the props of contentPanel.\r\n    // We only scroll when the state indicates we are at the bottom of the interactive window,\r\n    // otherwise it sometimes scrolls when the user wasn't at the bottom.\r\n    private scrollDiv = (div: HTMLDivElement) => {\r\n        if (this.props.isAtBottom) {\r\n            this.internalScrollCount += 1;\r\n            // Force auto here as smooth scrolling can be canceled by updates to the window\r\n            // from elsewhere (and keeping track of these would make this hard to maintain)\r\n            if (div && div.scrollIntoView) {\r\n                div.scrollIntoView({ behavior: 'auto', block: 'nearest', inline: 'nearest' });\r\n            }\r\n        }\r\n    };\r\n\r\n    private handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\r\n        if (this.internalScrollCount > 0) {\r\n            this.internalScrollCount -= 1;\r\n        } else if (this.contentPanelRef.current) {\r\n            const isAtBottom = this.props.settings?.alwaysScrollOnNewCell\r\n                ? true\r\n                : this.contentPanelRef.current.computeIsAtBottom(e.currentTarget);\r\n            this.props.scroll(isAtBottom);\r\n        }\r\n    };\r\n\r\n    private linkClick = (ev: MouseEvent) => {\r\n        handleLinkClick(ev, this.props.linkClick);\r\n    };\r\n}\r\n\r\n// Main export, return a redux connected editor\r\nexport function getConnectedInteractiveEditor() {\r\n    return connect(mapStateToProps, actionCreators)(InteractivePanel);\r\n}\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\nimport { Identifiers } from '../../../../client/datascience/constants';\r\nimport {\r\n    IFinishCell,\r\n    InteractiveWindowMessages\r\n} from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\r\nimport { ICell, IJupyterExtraSettings } from '../../../../client/datascience/types';\r\nimport { removeLinesFromFrontAndBack } from '../../../common';\r\nimport { createCellVM, extractInputText, ICellViewModel, IMainState } from '../../../interactive-common/mainState';\r\nimport { postActionToExtension } from '../../../interactive-common/redux/helpers';\r\nimport { Helpers } from '../../../interactive-common/redux/reducers/helpers';\r\nimport { IAddCellAction, ICellAction } from '../../../interactive-common/redux/reducers/types';\r\nimport { InteractiveReducerArg } from '../mapping';\r\n\r\nexport namespace Creation {\r\n    function isCellSupported(state: IMainState, cell: ICell): boolean {\r\n        // Skip message cells in test mode\r\n        if (state.testMode) {\r\n            return cell.data.cell_type !== 'messages';\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function extractInputBlockText(cellVM: ICellViewModel, settings?: IJupyterExtraSettings) {\r\n        // Use the base function first\r\n        const text = extractInputText(cellVM, settings);\r\n\r\n        // Then remove text on the front and back. We only do this for the interactive window\r\n        return removeLinesFromFrontAndBack(text);\r\n    }\r\n\r\n    export function alterCellVM(\r\n        cellVM: ICellViewModel,\r\n        settings?: IJupyterExtraSettings,\r\n        visible?: boolean,\r\n        expanded?: boolean\r\n    ): ICellViewModel {\r\n        if (cellVM.cell.data.cell_type === 'code') {\r\n            // If we are already in the correct state, return back our initial cell vm\r\n            if (cellVM.inputBlockShow === visible && cellVM.inputBlockOpen === expanded) {\r\n                return cellVM;\r\n            }\r\n\r\n            const newCellVM = { ...cellVM };\r\n            if (cellVM.inputBlockShow !== visible) {\r\n                if (visible) {\r\n                    // Show the cell, the rest of the function will add on correct collapse state\r\n                    newCellVM.inputBlockShow = true;\r\n                } else {\r\n                    // Hide this cell\r\n                    newCellVM.inputBlockShow = false;\r\n                }\r\n            }\r\n\r\n            // No elseif as we want newly visible cells to pick up the correct expand / collapse state\r\n            if (cellVM.inputBlockOpen !== expanded && cellVM.inputBlockCollapseNeeded && cellVM.inputBlockShow) {\r\n                let newText = extractInputBlockText(cellVM, settings);\r\n\r\n                // While extracting the text, we might eliminate all extra lines\r\n                if (newText.includes('\\n')) {\r\n                    if (expanded) {\r\n                        // Expand the cell\r\n                        newCellVM.inputBlockOpen = true;\r\n                        newCellVM.inputBlockText = newText;\r\n                    } else {\r\n                        // Collapse the cell\r\n                        if (newText.length > 0) {\r\n                            newText = newText.split('\\n', 1)[0];\r\n                            newText = newText.slice(0, 255); // Slice to limit length, slicing past length is fine\r\n                            newText = newText.concat('...');\r\n                        }\r\n\r\n                        newCellVM.inputBlockOpen = false;\r\n                        newCellVM.inputBlockText = newText;\r\n                    }\r\n                } else {\r\n                    // If all lines eliminated, get rid of the collapse bar.\r\n                    newCellVM.inputBlockCollapseNeeded = false;\r\n                    newCellVM.inputBlockOpen = true;\r\n                    newCellVM.inputBlockText = newText;\r\n                }\r\n            }\r\n\r\n            return newCellVM;\r\n        }\r\n\r\n        return cellVM;\r\n    }\r\n\r\n    export function prepareCellVM(cell: ICell, mainState: IMainState): ICellViewModel {\r\n        let cellVM: ICellViewModel = createCellVM(cell, mainState.settings, false, mainState.debugging);\r\n\r\n        const visible = mainState.settings ? mainState.settings.showCellInputCode : false;\r\n        const expanded = !mainState.settings?.collapseCellInputCodeByDefault;\r\n\r\n        // Set initial cell visibility and collapse\r\n        cellVM = alterCellVM(cellVM, mainState.settings, visible, expanded);\r\n        cellVM.hasBeenRun = true;\r\n\r\n        return cellVM;\r\n    }\r\n\r\n    export function startCell(arg: InteractiveReducerArg<ICell>): IMainState {\r\n        if (isCellSupported(arg.prevState, arg.payload.data)) {\r\n            const result = Helpers.updateOrAdd(arg, prepareCellVM);\r\n            if (\r\n                result.cellVMs.length > arg.prevState.cellVMs.length &&\r\n                arg.payload.data.id !== Identifiers.EditCellId\r\n            ) {\r\n                const cellVM = result.cellVMs[result.cellVMs.length - 1];\r\n\r\n                // We're adding a new cell here. Tell the intellisense engine we have a new cell\r\n                postActionToExtension(arg, InteractiveWindowMessages.UpdateModel, {\r\n                    source: 'user',\r\n                    kind: 'add',\r\n                    oldDirty: arg.prevState.dirty,\r\n                    newDirty: true,\r\n                    cell: cellVM.cell,\r\n                    fullText: extractInputText(cellVM, result.settings),\r\n                    currentText: cellVM.inputBlockText\r\n                });\r\n            }\r\n\r\n            return result;\r\n        }\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function updateCell(arg: InteractiveReducerArg<ICell>): IMainState {\r\n        if (isCellSupported(arg.prevState, arg.payload.data)) {\r\n            return Helpers.updateOrAdd(arg, prepareCellVM);\r\n        }\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function finishCell(arg: InteractiveReducerArg<IFinishCell>): IMainState {\r\n        if (isCellSupported(arg.prevState, arg.payload.data.cell)) {\r\n            return Helpers.updateOrAdd(\r\n                { ...arg, payload: { ...arg.payload, data: arg.payload.data.cell } },\r\n                prepareCellVM\r\n            );\r\n        }\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function deleteAllCells(arg: InteractiveReducerArg<IAddCellAction>): IMainState {\r\n        // Send messages to other side to indicate the deletes\r\n        postActionToExtension(arg, InteractiveWindowMessages.DeleteAllCells);\r\n\r\n        return {\r\n            ...arg.prevState,\r\n            cellVMs: [],\r\n            undoStack: Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs)\r\n        };\r\n    }\r\n\r\n    export function deleteCell(arg: InteractiveReducerArg<ICellAction>): IMainState {\r\n        const index = arg.prevState.cellVMs.findIndex((c) => c.cell.id === arg.payload.data.cellId);\r\n        if (index >= 0 && arg.payload.data.cellId) {\r\n            // Send messages to other side to indicate the delete\r\n            postActionToExtension(arg, InteractiveWindowMessages.UpdateModel, {\r\n                source: 'user',\r\n                kind: 'remove',\r\n                index,\r\n                oldDirty: arg.prevState.dirty,\r\n                newDirty: true,\r\n                cell: arg.prevState.cellVMs[index].cell\r\n            });\r\n\r\n            const newVMs = arg.prevState.cellVMs.filter((_c, i) => i !== index);\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: newVMs,\r\n                undoStack: Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs)\r\n            };\r\n        }\r\n\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function unmount(arg: InteractiveReducerArg): IMainState {\r\n        return {\r\n            ...arg.prevState,\r\n            cellVMs: [],\r\n            undoStack: [],\r\n            redoStack: [],\r\n            editCellVM: undefined\r\n        };\r\n    }\r\n\r\n    export function loaded(arg: InteractiveReducerArg<{ cells: ICell[] }>): IMainState {\r\n        postActionToExtension(arg, InteractiveWindowMessages.LoadAllCellsComplete, {\r\n            cells: []\r\n        });\r\n        return {\r\n            ...arg.prevState,\r\n            loaded: true,\r\n            busy: false\r\n        };\r\n    }\r\n}\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\nimport { Identifiers } from '../../../../client/datascience/constants';\r\nimport { IScrollToCell } from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\r\nimport { CssMessages } from '../../../../client/datascience/messages';\r\nimport { IJupyterExtraSettings } from '../../../../client/datascience/types';\r\nimport { IMainState } from '../../../interactive-common/mainState';\r\nimport { postActionToExtension } from '../../../interactive-common/redux/helpers';\r\nimport { CommonEffects } from '../../../interactive-common/redux/reducers/commonEffects';\r\nimport { Helpers } from '../../../interactive-common/redux/reducers/helpers';\r\nimport { ICellAction, IScrollAction } from '../../../interactive-common/redux/reducers/types';\r\nimport { computeEditorOptions } from '../../../react-common/settingsReactSide';\r\nimport { InteractiveReducerArg } from '../mapping';\r\nimport { Creation } from './creation';\r\n\r\nexport namespace Effects {\r\n    export function expandAll(arg: InteractiveReducerArg): IMainState {\r\n        if (arg.prevState.settings?.showCellInputCode) {\r\n            const newVMs = arg.prevState.cellVMs.map((c) =>\r\n                Creation.alterCellVM({ ...c }, arg.prevState.settings, true, true)\r\n            );\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: newVMs\r\n            };\r\n        }\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function collapseAll(arg: InteractiveReducerArg): IMainState {\r\n        if (arg.prevState.settings?.showCellInputCode) {\r\n            const newVMs = arg.prevState.cellVMs.map((c) =>\r\n                Creation.alterCellVM({ ...c }, arg.prevState.settings, true, false)\r\n            );\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: newVMs\r\n            };\r\n        }\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function toggleInputBlock(arg: InteractiveReducerArg<ICellAction>): IMainState {\r\n        if (arg.payload.data.cellId) {\r\n            const newVMs = [...arg.prevState.cellVMs];\r\n            const index = arg.prevState.cellVMs.findIndex((c) => c.cell.id === arg.payload.data.cellId);\r\n            const oldVM = arg.prevState.cellVMs[index];\r\n            newVMs[index] = Creation.alterCellVM({ ...oldVM }, arg.prevState.settings, true, !oldVM.inputBlockOpen);\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: newVMs\r\n            };\r\n        }\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function updateSettings(arg: InteractiveReducerArg<string>): IMainState {\r\n        // String arg should be the IDataScienceExtraSettings\r\n        const newSettingsJSON = JSON.parse(arg.payload.data);\r\n        const newSettings = <IJupyterExtraSettings>newSettingsJSON;\r\n        const newEditorOptions = computeEditorOptions(newSettings);\r\n        const newFontFamily = newSettings.extraSettings\r\n            ? newSettings.extraSettings.editor.fontFamily\r\n            : arg.prevState.font.family;\r\n        const newFontSize = newSettings.extraSettings\r\n            ? newSettings.extraSettings.editor.fontSize\r\n            : arg.prevState.font.size;\r\n\r\n        // Ask for new theme data if necessary\r\n        if (\r\n            newSettings &&\r\n            newSettings.extraSettings &&\r\n            newSettings.extraSettings.theme !== arg.prevState.vscodeThemeName\r\n        ) {\r\n            const knownDark = Helpers.computeKnownDark(newSettings);\r\n            // User changed the current theme. Rerender\r\n            postActionToExtension(arg, CssMessages.GetCssRequest, { isDark: knownDark });\r\n            postActionToExtension(arg, CssMessages.GetMonacoThemeRequest, { isDark: knownDark });\r\n        }\r\n\r\n        // Update our input cell state if the user changed this setting\r\n        let newVMs = arg.prevState.cellVMs;\r\n        if (newSettings.showCellInputCode !== arg.prevState.settings?.showCellInputCode) {\r\n            newVMs = arg.prevState.cellVMs.map((c) =>\r\n                Creation.alterCellVM(\r\n                    c,\r\n                    newSettings,\r\n                    newSettings.showCellInputCode,\r\n                    !newSettings.collapseCellInputCodeByDefault\r\n                )\r\n            );\r\n        }\r\n\r\n        return {\r\n            ...arg.prevState,\r\n            cellVMs: newVMs,\r\n            settings: newSettings,\r\n            editorOptions: newEditorOptions,\r\n            font: {\r\n                size: newFontSize,\r\n                family: newFontFamily\r\n            }\r\n        };\r\n    }\r\n\r\n    export function scrollToCell(arg: InteractiveReducerArg<IScrollToCell>): IMainState {\r\n        // Up the scroll count on the necessary cell\r\n        const index = arg.prevState.cellVMs.findIndex((c) => c.cell.id === arg.payload.data.id);\r\n        if (index >= 0) {\r\n            const newVMs = [...arg.prevState.cellVMs];\r\n\r\n            // Scroll one cell and unscroll another.\r\n            newVMs[index] = { ...newVMs[index], scrollCount: newVMs[index].scrollCount + 1 };\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: newVMs\r\n            };\r\n        }\r\n\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function scrolled(arg: InteractiveReducerArg<IScrollAction>): IMainState {\r\n        return {\r\n            ...arg.prevState,\r\n            isAtBottom: arg.payload.data.isAtBottom\r\n        };\r\n    }\r\n\r\n    export function clickCell(arg: InteractiveReducerArg<ICellAction>): IMainState {\r\n        if (\r\n            arg.payload.data.cellId === Identifiers.EditCellId &&\r\n            arg.prevState.editCellVM &&\r\n            !arg.prevState.editCellVM.focused\r\n        ) {\r\n            return {\r\n                ...arg.prevState,\r\n                editCellVM: {\r\n                    ...arg.prevState.editCellVM,\r\n                    focused: true\r\n                }\r\n            };\r\n        } else if (arg.prevState.editCellVM && arg.payload.data.cellId !== Identifiers.EditCellId) {\r\n            return {\r\n                ...arg.prevState,\r\n                editCellVM: {\r\n                    ...arg.prevState.editCellVM,\r\n                    focused: false\r\n                }\r\n            };\r\n        }\r\n\r\n        // If no change, make sure focus updates\r\n        return CommonEffects.focusPending(arg.prevState);\r\n    }\r\n\r\n    export function unfocusCell(arg: InteractiveReducerArg<ICellAction>): IMainState {\r\n        if (\r\n            arg.payload.data.cellId === Identifiers.EditCellId &&\r\n            arg.prevState.editCellVM &&\r\n            arg.prevState.editCellVM.focused\r\n        ) {\r\n            return {\r\n                ...arg.prevState,\r\n                editCellVM: {\r\n                    ...arg.prevState.editCellVM,\r\n                    focused: false\r\n                }\r\n            };\r\n        }\r\n\r\n        return arg.prevState;\r\n    }\r\n}\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\n// tslint:disable-next-line: no-require-imports no-var-requires\r\nconst cloneDeep = require('lodash/cloneDeep');\r\nimport * as uuid from 'uuid/v4';\r\n\r\nimport { CellMatcher } from '../../../../client/datascience/cellMatcher';\r\nimport { InteractiveWindowMessages } from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\r\nimport { CellState } from '../../../../client/datascience/types';\r\nimport { generateMarkdownFromCodeLines } from '../../../common';\r\nimport { createCellFrom } from '../../../common/cellFactory';\r\nimport { createCellVM, IMainState } from '../../../interactive-common/mainState';\r\nimport { postActionToExtension } from '../../../interactive-common/redux/helpers';\r\nimport { Helpers } from '../../../interactive-common/redux/reducers/helpers';\r\nimport { ICodeAction } from '../../../interactive-common/redux/reducers/types';\r\nimport { InteractiveReducerArg } from '../mapping';\r\nimport { Creation } from './creation';\r\n\r\nexport namespace Execution {\r\n    export function undo(arg: InteractiveReducerArg): IMainState {\r\n        if (arg.prevState.undoStack.length > 0) {\r\n            // Pop one off of our undo stack and update our redo\r\n            const cells = arg.prevState.undoStack[arg.prevState.undoStack.length - 1];\r\n            const undoStack = arg.prevState.undoStack.slice(0, arg.prevState.undoStack.length - 1);\r\n            const redoStack = Helpers.pushStack(arg.prevState.redoStack, arg.prevState.cellVMs);\r\n            postActionToExtension(arg, InteractiveWindowMessages.Undo);\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: cells,\r\n                undoStack: undoStack,\r\n                redoStack: redoStack,\r\n                skipNextScroll: true\r\n            };\r\n        }\r\n\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function redo(arg: InteractiveReducerArg): IMainState {\r\n        if (arg.prevState.redoStack.length > 0) {\r\n            // Pop one off of our redo stack and update our undo\r\n            const cells = arg.prevState.redoStack[arg.prevState.redoStack.length - 1];\r\n            const redoStack = arg.prevState.redoStack.slice(0, arg.prevState.redoStack.length - 1);\r\n            const undoStack = Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs);\r\n            postActionToExtension(arg, InteractiveWindowMessages.Redo);\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: cells,\r\n                undoStack: undoStack,\r\n                redoStack: redoStack,\r\n                skipNextScroll: true\r\n            };\r\n        }\r\n\r\n        return arg.prevState;\r\n    }\r\n\r\n    export function startDebugging(arg: InteractiveReducerArg): IMainState {\r\n        return {\r\n            ...arg.prevState,\r\n            debugging: true\r\n        };\r\n    }\r\n\r\n    export function stopDebugging(arg: InteractiveReducerArg): IMainState {\r\n        return {\r\n            ...arg.prevState,\r\n            debugging: false\r\n        };\r\n    }\r\n\r\n    export function submitInput(arg: InteractiveReducerArg<ICodeAction>): IMainState {\r\n        // noop if the submitted code is just a cell marker\r\n        const matcher = new CellMatcher(arg.prevState.settings);\r\n        if (matcher.stripFirstMarker(arg.payload.data.code).length > 0 && arg.prevState.editCellVM) {\r\n            // This should be from the edit cell VM. Copy it and change the cell id\r\n            let newCell = cloneDeep(arg.prevState.editCellVM);\r\n\r\n            // Change this editable cell to not editable.\r\n            newCell.cell.state = CellState.executing;\r\n            newCell.cell.data.source = arg.payload.data.code;\r\n\r\n            // Change type to markdown if necessary\r\n            const split = arg.payload.data.code.splitLines({ trim: false });\r\n            const firstLine = split[0];\r\n            if (matcher.isMarkdown(firstLine)) {\r\n                newCell.cell.data = createCellFrom(newCell.cell.data, 'markdown');\r\n                newCell.cell.data.source = generateMarkdownFromCodeLines(split);\r\n                newCell.cell.state = CellState.finished;\r\n            } else if (newCell.cell.data.cell_type === 'markdown') {\r\n                newCell.cell.state = CellState.finished;\r\n            }\r\n\r\n            // Update input controls (always show expanded since we just edited it.)\r\n            newCell = createCellVM(newCell.cell, arg.prevState.settings, false, false);\r\n            const collapseInputs = arg.prevState.settings\r\n                ? arg.prevState.settings.collapseCellInputCodeByDefault\r\n                : false;\r\n            newCell = Creation.alterCellVM(newCell, arg.prevState.settings, true, !collapseInputs);\r\n            newCell.useQuickEdit = false;\r\n\r\n            // Generate a new id\r\n            newCell.cell.id = uuid();\r\n\r\n            // Indicate this is direct input so that we don't hide it if the user has\r\n            // hide all inputs turned on.\r\n            newCell.directInput = true;\r\n\r\n            // Send a message to execute this code if necessary.\r\n            if (newCell.cell.state !== CellState.finished) {\r\n                postActionToExtension(arg, InteractiveWindowMessages.SubmitNewCell, {\r\n                    code: arg.payload.data.code,\r\n                    id: newCell.cell.id\r\n                });\r\n            }\r\n\r\n            // Stick in a new cell at the bottom that's editable and update our state\r\n            // so that the last cell becomes busy\r\n            return {\r\n                ...arg.prevState,\r\n                cellVMs: [...arg.prevState.cellVMs, newCell],\r\n                undoStack: Helpers.pushStack(arg.prevState.undoStack, arg.prevState.cellVMs),\r\n                skipNextScroll: false,\r\n                submittedText: true\r\n            };\r\n        }\r\n        return arg.prevState;\r\n    }\r\n}\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\nimport { InteractiveWindowMessages } from '../../../../client/datascience/interactive-common/interactiveWindowTypes';\r\nimport { CssMessages, SharedMessages } from '../../../../client/datascience/messages';\r\nimport { CommonEffects } from '../../../interactive-common/redux/reducers/commonEffects';\r\nimport { Kernel } from '../../../interactive-common/redux/reducers/kernel';\r\nimport { Transfer } from '../../../interactive-common/redux/reducers/transfer';\r\nimport { CommonActionType } from '../../../interactive-common/redux/reducers/types';\r\nimport { IInteractiveActionMapping } from '../mapping';\r\nimport { Creation } from './creation';\r\nimport { Effects } from './effects';\r\nimport { Execution } from './execution';\r\n\r\n// The list of reducers. 1 per message/action.\r\nexport const reducerMap: Partial<IInteractiveActionMapping> = {\r\n    // State updates\r\n    [CommonActionType.RESTART_KERNEL]: Kernel.restartKernel,\r\n    [CommonActionType.INTERRUPT_KERNEL]: Kernel.interruptKernel,\r\n    [InteractiveWindowMessages.SelectKernel]: Kernel.selectKernel,\r\n    [CommonActionType.SELECT_SERVER]: Kernel.selectJupyterURI,\r\n    [CommonActionType.OPEN_SETTINGS]: CommonEffects.openSettings,\r\n    [CommonActionType.EXPORT]: Transfer.exportCells,\r\n    [CommonActionType.EXPORT_NOTEBOOK_AS]: Transfer.showExportAsMenu,\r\n    [CommonActionType.SAVE]: Transfer.save,\r\n    [CommonActionType.SHOW_DATA_VIEWER]: Transfer.showDataViewer,\r\n    [CommonActionType.DELETE_CELL]: Creation.deleteCell,\r\n    [InteractiveWindowMessages.ShowPlot]: Transfer.showPlot,\r\n    [CommonActionType.LINK_CLICK]: Transfer.linkClick,\r\n    [CommonActionType.GOTO_CELL]: Transfer.gotoCell,\r\n    [CommonActionType.TOGGLE_INPUT_BLOCK]: Effects.toggleInputBlock,\r\n    [CommonActionType.COPY_CELL_CODE]: Transfer.copyCellCode,\r\n    [CommonActionType.EDIT_CELL]: Transfer.editCell,\r\n    [CommonActionType.SUBMIT_INPUT]: Execution.submitInput,\r\n    [InteractiveWindowMessages.ExpandAll]: Effects.expandAll,\r\n    [CommonActionType.EDITOR_LOADED]: Transfer.started,\r\n    [InteractiveWindowMessages.LoadAllCells]: Creation.loaded,\r\n    [CommonActionType.SCROLL]: Effects.scrolled,\r\n    [CommonActionType.CLICK_CELL]: Effects.clickCell,\r\n    [CommonActionType.UNFOCUS_CELL]: Effects.unfocusCell,\r\n    [CommonActionType.UNMOUNT]: Creation.unmount,\r\n    [CommonActionType.FOCUS_INPUT]: CommonEffects.focusInput,\r\n    [CommonActionType.LOAD_IPYWIDGET_CLASS_SUCCESS]: CommonEffects.handleLoadIPyWidgetClassSuccess,\r\n    [CommonActionType.LOAD_IPYWIDGET_CLASS_FAILURE]: CommonEffects.handleLoadIPyWidgetClassFailure,\r\n    [CommonActionType.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED]: CommonEffects.notifyAboutUnsupportedWidgetVersions,\r\n    [CommonActionType.IPYWIDGET_RENDER_FAILURE]: CommonEffects.handleIPyWidgetRenderFailure,\r\n\r\n    // Messages from the webview (some are ignored)\r\n    [InteractiveWindowMessages.Undo]: Execution.undo,\r\n    [InteractiveWindowMessages.Redo]: Execution.redo,\r\n    [InteractiveWindowMessages.StartCell]: Creation.startCell,\r\n    [InteractiveWindowMessages.FinishCell]: Creation.finishCell,\r\n    [InteractiveWindowMessages.UpdateCellWithExecutionResults]: Creation.updateCell,\r\n    [InteractiveWindowMessages.RestartKernel]: Kernel.handleRestarted,\r\n    [CssMessages.GetCssResponse]: CommonEffects.handleCss,\r\n    [InteractiveWindowMessages.MonacoReady]: CommonEffects.monacoReady,\r\n    [CssMessages.GetMonacoThemeResponse]: CommonEffects.monacoThemeChange,\r\n    [InteractiveWindowMessages.GetAllCells]: Transfer.getAllCells,\r\n    [InteractiveWindowMessages.ExpandAll]: Effects.expandAll,\r\n    [InteractiveWindowMessages.CollapseAll]: Effects.collapseAll,\r\n    [InteractiveWindowMessages.DeleteAllCells]: Creation.deleteAllCells,\r\n    [InteractiveWindowMessages.StartProgress]: CommonEffects.startProgress,\r\n    [InteractiveWindowMessages.StopProgress]: CommonEffects.stopProgress,\r\n    [SharedMessages.UpdateSettings]: Effects.updateSettings,\r\n    [InteractiveWindowMessages.StartDebugging]: Execution.startDebugging,\r\n    [InteractiveWindowMessages.StopDebugging]: Execution.stopDebugging,\r\n    [InteractiveWindowMessages.ScrollToCell]: Effects.scrollToCell,\r\n    [InteractiveWindowMessages.UpdateKernel]: Kernel.updateStatus,\r\n    [SharedMessages.LocInit]: CommonEffects.handleLocInit,\r\n    [InteractiveWindowMessages.UpdateDisplayData]: CommonEffects.handleUpdateDisplayData,\r\n    [InteractiveWindowMessages.HasCell]: Transfer.hasCell,\r\n    [InteractiveWindowMessages.UpdateExternalCellButtons]: CommonEffects.handleWebviewButtons,\r\n    [InteractiveWindowMessages.ExecuteExternalCommand]: Transfer.executeExternalCommand\r\n};\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\n\r\n// This must be on top, do not change. Required by webpack.\r\nimport '../common/main';\r\n// This must be on top, do not change. Required by webpack.\r\n\r\n// tslint:disable-next-line: ordered-imports\r\nimport '../common/index.css';\r\n\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\n\r\nimport { TextAreaFocusTracker } from '../interactive-common/textAreaFocusTracker';\r\nimport { WidgetManagerComponent } from '../ipywidgets/webViews/container';\r\nimport { IVsCodeApi, PostOffice } from '../react-common/postOffice';\r\nimport { detectBaseTheme } from '../react-common/themeDetector';\r\nimport { getConnectedInteractiveEditor } from './interactivePanel';\r\nimport { createStore } from './redux/store';\r\n\r\n// This special function talks to vscode from a web panel\r\nexport declare function acquireVsCodeApi(): IVsCodeApi;\r\nconst baseTheme = detectBaseTheme();\r\n// tslint:disable-next-line: no-any\r\nconst testMode = (window as any).inTestMode;\r\n// tslint:disable-next-line: no-typeof-undefined\r\nconst skipDefault = testMode ? false : typeof acquireVsCodeApi !== 'undefined';\r\n\r\n// Create the redux store\r\nconst postOffice = new PostOffice();\r\nconst store = createStore(skipDefault, baseTheme, testMode, postOffice);\r\n\r\n// Wire up a connected react control for our InteractiveEditor\r\nconst ConnectedInteractiveEditor = getConnectedInteractiveEditor();\r\n\r\n// Stick them all together\r\n// tslint:disable:no-typeof-undefined\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <TextAreaFocusTracker />\r\n        <ConnectedInteractiveEditor />\r\n        <WidgetManagerComponent postOffice={postOffice} widgetContainerId={'rootWidget'} store={store} />\r\n    </Provider>,\r\n    document.getElementById('root') as HTMLElement\r\n);\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n'use strict';\r\n\r\nimport * as ReduxCommon from '../../interactive-common/redux/store';\r\nimport { PostOffice } from '../../react-common/postOffice';\r\nimport { reducerMap } from './reducers';\r\n\r\n// This special version uses the reducer map from the IInteractiveWindowMapping\r\nexport function createStore(skipDefault: boolean, baseTheme: string, testMode: boolean, postOffice: PostOffice) {\r\n    return ReduxCommon.createStore(skipDefault, baseTheme, testMode, false, false, reducerMap, postOffice);\r\n}\r\n","\nvar content = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/less-loader/dist/cjs.js!./interactivePanel.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/less-loader/dist/cjs.js!./interactivePanel.less\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/less-loader/dist/cjs.js!./interactivePanel.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","module.exports = log4js;"],"sourceRoot":""}